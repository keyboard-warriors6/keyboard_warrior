{% extends 'base_profile.html' %}
{% load static %}
{% load humanize %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock head %}

{% block content %}
  <!-- 프로필 -->
  <div class="title-container">
    <p class="text-4xl">프로필</p>
  </div>

  <div class="profile-container">
    <div class="flex flex-row">
      <div class="profile-image m-10">
        {% if user.profile_img %}
          <img src="{{ user.profile_img.url }}" alt="profile_img">
        {% else %}
          <img src="https://i.pinimg.com/564x/d2/98/4e/d2984ec4b65a8568eab3dc2b640fc58e.jpg" alt="no_image">
        {% endif %}
      </div>
      <div class="mt-14">
        <p class="user-name">{{ user }}</p>
        <div class="flex items-end gap-4">
          <a href="{% url 'accounts:update' user.username %}">
            <button class="button-setting mt-10">
              <p class="text-base">설정</p>
            </button>
          </a>
          <a href="{% url 'accounts:logout' %}">
            <button class="button-setting-big logout-button mt-10">
              <p class="text-sm">로그아웃</p>
            </button>
          </a>
        </div>
      </div>
      <section id="example-1">
    </div>

    {% comment %} <hr class="profile-line">
    
    <div class="flex flex-row justify-around">
      <div class="text-center m-5">
        <img src="/static/img/icon_bookmark.png" alt="icon_bookmark" class="profile-icon">

        <p>스크랩북</p>
        <p>0</p>
      </div>
      <div class="text-center m-5">
        <img src="/static/img/icon_heart.png" alt="icon_heart" class="profile-icon">
        <p>리뷰스크랩</p>
        <p>0</p>
      </div>      <div class="text-center m-5">
        <img src="/static/img/icon_coupon.png" alt="icon_coupon" class="profile-icon">
        <p>쿠폰</p>
        <p>0</p>
      </div>
    </div> {% endcomment %}
  </div>
  

  <!-- 나의 쇼핑 -->
  <div></div>
  <div class="title-container mt-36">
    <p class="text-4xl">나의 쇼핑</p>
  </div>

  <!-- 조회 결과 없을 때, 차후에 if문으로 변경할 것 -->
  <div class="purchased_item-container">
    <button id="dropdownDefaultButton" data-dropdown-toggle="dropdown" class="text-white bg-[#99ccff] hover:bg-[#409fff] font-medium rounded-lg text-sm px-4 py-2.5 m-10 text-center inline-flex items-center" type="button">조회 기간<svg class="w-4 h-4 ml-2" aria-hidden="true" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>
    <!-- Dropdown menu -->
    <div id="dropdown" class="z-10 hidden bg-white divide-y rounded-lg shadow w-44">
      <ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="dropdownDefaultButton">
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">1개월 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">3개월 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">6개월 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">1년 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">2년 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">3년 전</a>
        </li>
      </ul>
    </div>
    <p class='text-xl text-center mb-20'>주문하신 내역이 없습니다.</p>
  </div>

    <!-- 조회 결과가 1건이라도 있을 때 -->
  <div class="purchased_item-container">
    <button id="dropdownDefaultButton" data-dropdown-toggle="dropdown" class="text-white bg-[#99ccff] hover:bg-[#409fff] font-medium rounded-lg text-sm px-4 py-2.5 m-10 text-center inline-flex items-center" type="button">조회 기간<svg class="w-4 h-4 ml-2" aria-hidden="true" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></button>
    <!-- Dropdown menu -->
    <div id="dropdown" class="z-10 hidden bg-white divide-y rounded-lg shadow w-44">
      <ul class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="dropdownDefaultButton">
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">1개월 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">3개월 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">6개월 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">1년 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">2년 전</a>
        </li>
        <li>
          <a href="#" class="block px-4 py-2 hover:bg-[#99ccff]">3년 전</a>
        </li>
      </ul>
    </div>


      {% comment %} {% for purchase in purchase_list %}
        {% for product in purchase.products.all %}
            {{ product.category.brand }}
        {% endfor %}
      {% endfor %} {% endcomment %}
      
      {% for purchase in purchase_list %}
      <ul>
        {{ purchase.products.first.category.brand }} -
        {{ purchase.products.first.name }}
        {{ purchase.products.first.product_img }}
        <br>
      </ul>
 
          {% comment %} {% for purchase_item in purchase.purchase_items %}
            <li>
              Product: {{ purchase_item.product }}
              Quantity: {{ purchase_item.cnt }}
            </li>
          {% endfor %} {% endcomment %}
      {% endfor %}
    </ul>
    <br>
    {% for purchase in purchase_list %}
      <p class="text-xl ms-5 p-3">{{ purchase.date|date:'Y-m-d' }}</p>
      <hr class="purchase-line">

      <p class="text-xl ms-10 mt-5 "><span class="text-[#99ccff]">구매확정 {{ purchase.date|date:"n월 j일" }}</span> - 도착완료</p>
      <div class="flex flex-row">
        <div class="purchased_item-image m-10">
          <img src="/static/img/products_sample.png" alt="icon_profile">
        </div>

        <div class="mt-10" style="width: 15rem;">
          <p class="text-sm mb-1">{{ purchase.products.first.category.brand }}</p>
          <p class="text-lg mb-1">{{ purchase.products.first.name }}</p>
        </div>

        <div class="ms-24 mt-10">
          <p class="text-xl mb-1">{{ purchase.products.first.discounted_price|intcomma }}원 1개</p>          
          {% for purchase_item in purchase.purchase_items %}
            <li>
              Quantity: {{ purchase_item.cnt }}
            </li>
          {% endfor %}

          <p class="text-[#99ccff]">일반택배</p>
        </div>

        <div class="ms-36 flex flex-column">
          <button class="button-big button-color-delivery mt-5">
            <p class="text-base">배송 추적</p> <!-- 기능 변경 필요, 배송 현황은 알 수 없을 것 같아서 예를 들면 상품 보러가기 라던지 -->
          </button>
          <a href="/products/{{ product.product.pk }}">
            <button class="button-big button-color-review mt-8">
              <p class="text-base">리뷰 작성</p>
            </button>
          </a>
          </ahref=>
        </div>
      </div>
    {% endfor %}
    <section id="example-2">
  </div>



  <!-- 나의 리뷰 -->
  <div class="title-container mt-36">
    <p class="text-4xl">나의 리뷰</p>
  </div>

  <!-- 조회 결과 없을 때, 차후에 if문으로 변경할 것 --> 
  <div class="purchased_item-container">
    <button class="button-middle button-color-delivery ms-10 my-10">
      <p>베스트</p>
    </button>
    <button class="button-middle button-color-delivery ms-3 my-10">
      <p>최신순</p>
    </button>
    <p class='text-xl text-center mb-20'>리뷰를 작성하신 내역이 없습니다.</p>
  </div>

  <!-- 조회 결과가 1건이라도 있을 때 -->
  <div class="purchased_item-container">
    <button class="button-middle button-color-delivery ms-10 mt-10">
      <p>베스트</p>
    </button>
    <button class="button-middle button-color-delivery ms-3 mt-10">
      <p>최신순</p>
    </button>

    <div class="flex flex-row">
      <div class="my-10 ms-10">
        <p class="text-xl mb-2">[라이프썸] 슬림 블루투스 업무용 저소음 키보드</p>
        <p class="text-sm mb-2">⭐⭐⭐⭐⭐ 2023.05.12</p>
        <p class="text-lg mb-2">키보드는 나의 든든한 동반자입니다. </p>

      </div>
      <div class="ms-auto me-12">
        <button class="button-big button-color-review mt-8">
          <p class="text-base">리뷰 수정</p>
        </button>
      </div>
    </div>

    <div class="flex flex-row">
      <div class="my-10 ms-10">
        <p class="text-xl mb-2">[라이프썸] 슬림 블루투스 업무용 저소음 키보드</p>
        <p class="text-sm mb-2">⭐⭐⭐⭐⭐ 2023.05.12</p>
        <p class="text-lg mb-2">키보드는 나의 든든한 동반자입니다. </p>
      </div>
      <div class="ms-auto me-12">
        <button class="button-big button-color-review mt-8">
          <p class="text-base">리뷰 수정</p>
        </button>
      </div>
    </div>

    <div class="flex flex-row">
      <div class="my-10 ms-10">
        <p class="text-xl mb-2">[라이프썸] 슬림 블루투스 업무용 저소음 키보드</p>
        <p class="text-sm mb-2">⭐⭐⭐⭐⭐ 2023.05.12</p>
        <p class="text-lg mb-2">키보드는 나의 든든한 동반자입니다. </p>
      </div>
      <div class="ms-auto me-12">
        <button class="button-big button-color-review mt-8">
          <p class="text-base">리뷰 수정</p>
        </button>
      </div>
    </div>

    <div class="flex flex-row">
      <div class="my-10 ms-10">
        <p class="text-xl mb-2">[라이프썸] 슬림 블루투스 업무용 저소음 키보드</p>
        <p class="text-sm mb-2">⭐⭐⭐⭐⭐ 2023.05.12</p>
        <p class="text-lg mb-2">키보드는 나의 든든한 동반자입니다. </p>
      </div>
      <div class="ms-auto me-12">
        <button class="button-big button-color-review mt-8">
          <p class="text-base">리뷰 수정</p>
        </button>
      </div>
    </div>

    <div class="flex flex-row">
      <div class="my-10 ms-10">
        <p class="text-xl mb-2">[라이프썸] 슬림 블루투스 업무용 저소음 키보드</p>
        <p class="text-sm mb-2">⭐⭐⭐⭐⭐ 2023.05.12</p>
        <p class="text-lg mb-2">키보드는 나의 든든한 동반자입니다. </p>
      </div>
      <div class="ms-auto me-12">
        <button class="button-big button-color-review mt-8">
          <p class="text-base">리뷰 수정</p>
        </button>
      </div>
    </div>
    <section id="example-3">
  </div>
  
  <!-- 나의 문의 -->
  <div class="title-container mt-36">
    <p class="text-4xl">나의 문의</p>
  </div>

  <!-- 조회 결과가 1건이라도 있을 때 -->
  <div class="purchased_item-container mb-36">
    <button class="button-middle button-color-delivery ms-10 mt-10">
      <p>전체 보기</p>
    </button>
    <button class="button-middle button-color-delivery ms-3 mt-10">
      <p>답변 완료</p>
    </button>
    {% if inquiries %}
      {% for inquiry in inquiries %}
        <div class="flex flex-row">
          <div class="my-10 ms-10 me-20">
            <p class="text-xl mb-2">[{{ inquiry.product.category.brand }}] {{ inquiry.product.name }} </p>
            <p class="text-sm mb-5"> {{ inquiry.created_at }}</p>

            <div class="mb-2.5">
              <p class='ms-5 mb-5'><span class="product-inquiry-qa">Q &nbsp;</span>{{ inquiry.content }}</p>
            </div>
            
            {% if inquiry.answer %}
              <div class="mb-2.5">
                <p class='ms-5 mb-5'><span class="product-inquiry-qa">A &nbsp;</span><span style="font-weight: 700; color: #424242; font-size: 15px;">주식회사 인스토어 &nbsp;</span><span style="font-size: 12px; color: #bdbdbd;">{{ inquiry.answer.created_at }}</span></p>
                <p class='ms-5'>{{ inquiry.answer.content }}</p>
              </div>
            {% endif %}
          </div>
          
          <div class="ms-auto me-12 flex justify-center items-center">
            <a data-te-nav-link-ref class="bg-transparent px-[5px] menubar-content-list font-semibold text-neutral-600 shadow-none" href="/products/{{ inquiry.product.pk }}/#example-4">
              <button class="button-big button-color-review">
                <p class="text-base">답변 보러가기</p>
              </button>
            </a>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p class='text-xl text-center mb-20'>문의하신 내역이 없습니다.</p>
    {% endif %}
  </div>
{% endblock content %}

{% block script %}
  {% comment %} <script type="module" src="{% static 'js/profile.js' %}"></script> {% endcomment %}
{% endblock script %}